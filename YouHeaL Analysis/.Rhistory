stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q7_YRBS_juice)) + ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]]))
plot_complete_items(quo(Q8_YRBS_fruit)) + ggtitle(label(analytic_cohort[["Q8_YRBS_fruit"]]))
plot_complete_items(quo(Q9_YRBS_salad)) + ggtitle(label(analytic_cohort[["Q9_YRBS_salad"]]))
plot_complete_items(quo(Q10_YRBS_potato)) + ggtitle(label(analytic_cohort[["Q10_YRBS_potato"]]))
plot_complete_items(quo(Q11_YRBS_carrot)) + ggtitle(label(analytic_cohort[["Q11_YRBS_carrot"]]))
plot_complete_items(quo(Q12_YRBS_otherveg)) + ggtitle(label(analytic_cohort[["Q12_YRBS_otherveg"]]))
plot_complete_items(quo(Q13_YRBS_soda)) + ggtitle(label(analytic_cohort[["Q13_YRBS_soda"]]))
plot_complete_items(quo(Q14_YRBS_sportdrink)) + ggtitle(label(analytic_cohort[["Q14_YRBS_sportdrink"]]))
plot_complete_items(quo(Q15_YRBS_water)) + ggtitle(label(analytic_cohort[["Q15_YRBS_water"]]))
plot_complete_items(quo(Q16_YRBS_milk)) + ggtitle(label(analytic_cohort[["Q16_YRBS_milk"]]))
plot_complete_items(quo(Q17_YRBS_breakfast)) + ggtitle(label(analytic_cohort[["Q17_YRBS_breakfast"]]))
# analytic_cohort_completecase %>%
#   mutate(Q7_YRBS_juice = str_wrap(Q7_YRBS_juice, 28)) %>%
#     ggplot(aes(x = phase, y = fct_rev(Q7_YRBS_juice), group = ID, color = cohort)) +
#     geom_line(aes(alpha = 0.01)) +
#     # add theme colors (set in first chunk)
#     yh_cohort_colors() +
#     # remove legend
#     theme(
#       plot.title = element_text(hjust = 0.5),
#       legend.position = "none",
#       axis.text.x = element_text(size = 10),
#       axis.text.y = element_text(size = 10)
#       ) +
#     stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
#   ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]])) +
#   ylab("") +
#   xlab(label = "\nPhase")
# index variable for number of words to wrap item responses
wrap_var <- 28
# format items so they are string wrapped and ordered appropriately
analytic_cohort_completecase_fct <- analytic_cohort_completecase %>%
mutate(
# YRBS diet items
Q7_YRBS_juice = Q7_YRBS_juice %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q8_YRBS_fruit = Q8_YRBS_fruit %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q9_YRBS_salad = Q9_YRBS_salad %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q10_YRBS_potato = Q10_YRBS_potato %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q11_YRBS_carrot = Q11_YRBS_carrot %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q12_YRBS_otherveg = Q12_YRBS_otherveg %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q13_YRBS_soda = Q13_YRBS_soda %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q14_YRBS_sportdrink = Q14_YRBS_sportdrink %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q15_YRBS_water = Q15_YRBS_water %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q16_YRBS_milk = Q16_YRBS_milk %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q17_YRBS_breakfast = Q17_YRBS_breakfast %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
# YRBS physical items
Q19_YRBS_physical = Q19_YRBS_physical %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q20_YRBS_strength = Q20_YRBS_strength %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q21_YRBS_tv = Q21_YRBS_tv %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q22_YRBS_screentime = Q22_YRBS_screentime %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
# unused YRBS items
Q18_YRBS_allergy = Q18_YRBS_allergy %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q23_YRBS_pe = Q23_YRBS_pe %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q24_YRBS_sportsteam = Q24_YRBS_sportsteam %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q25_YRBS_concussion = Q25_YRBS_concussion %>% str_wrap(wrap_var) %>% forcats::fct_rev()
)
# function to plot individual items
plot_complete_items <- function(variable){
analytic_cohort_completecase_fct %>%
drop_na_(variable) %>%
ggplot(aes(x = phase, y = !!variable, group = ID, color = cohort)) +
geom_line(aes(alpha = 0.01)) +
# add theme colors (set in first chunk)
yh_cohort_colors() +
# remove legend
theme(
plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
) +
stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q7_YRBS_juice)) + ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]]))
plot_complete_items(quo(Q8_YRBS_fruit)) + ggtitle(label(analytic_cohort[["Q8_YRBS_fruit"]]))
plot_complete_items(quo(Q9_YRBS_salad)) + ggtitle(label(analytic_cohort[["Q9_YRBS_salad"]]))
plot_complete_items(quo(Q10_YRBS_potato)) + ggtitle(label(analytic_cohort[["Q10_YRBS_potato"]]))
plot_complete_items(quo(Q11_YRBS_carrot)) + ggtitle(label(analytic_cohort[["Q11_YRBS_carrot"]]))
plot_complete_items(quo(Q12_YRBS_otherveg)) + ggtitle(label(analytic_cohort[["Q12_YRBS_otherveg"]]))
plot_complete_items(quo(Q13_YRBS_soda)) + ggtitle(label(analytic_cohort[["Q13_YRBS_soda"]]))
plot_complete_items(quo(Q14_YRBS_sportdrink)) + ggtitle(label(analytic_cohort[["Q14_YRBS_sportdrink"]]))
plot_complete_items(quo(Q15_YRBS_water)) + ggtitle(label(analytic_cohort[["Q15_YRBS_water"]]))
plot_complete_items(quo(Q16_YRBS_milk)) + ggtitle(label(analytic_cohort[["Q16_YRBS_milk"]]))
plot_complete_items(quo(Q17_YRBS_breakfast)) + ggtitle(label(analytic_cohort[["Q17_YRBS_breakfast"]]))
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
# sociodemographic variables
label(analytic_cohort$age) <- "Age (Years)"
label(analytic_cohort$sex) <- "Sex"
label(analytic_cohort$city_LA) <- "In what city do you currently live?"
label(analytic_cohort$race_HL) <- "Is your race Hispanic/Latino?"
label(analytic_cohort$race_AAB) <- "Is your race African American or Black?"
label(analytic_cohort$race_asian) <- "Is your race Asian?"
label(analytic_cohort$race_wo) <- "Is your race White only?"
label(analytic_cohort$language1) <- "What language do you mainly speak at home?"
label(analytic_cohort$english_prof) <- "How well do you speak English?"
# YRBS diet and physical activity composite variables
label(analytic_cohort$YRBS_diet_total) <- "YRBS Diet Composite"
label(analytic_cohort$YRBS_physical_total) <- "YRBS Physical Activity Composite"
# self-efficacy variable
label(analytic_cohort$total_efficacy) <- "General Self-Efficacy"
# empowerment variables
label(analytic_cohort$empower_composite) <- "Composite Empowerment"
label(analytic_cohort$empower_individual) <- "Individual Empowerment"
label(analytic_cohort$empower_community) <- "Community Empowerment"
label(analytic_cohort$empower_organization) <- "Organizational Empowerment"
# anthropometric variables
label(analytic_cohort$TSF_avg) <- "Triceps Skinfold (mm)"
label(analytic_cohort$WC_avg) <- "Waist Circumference (cm)"
# YRBS diet items
label(analytic_cohort$Q7_YRBS_juice) <- "Drink 100% Fruit Juices?"
label(analytic_cohort$Q8_YRBS_fruit) <- "Eat Fruit?"
label(analytic_cohort$Q9_YRBS_salad) <- "Eat Green Salad?"
label(analytic_cohort$Q10_YRBS_potato) <- "Eat Potatoes?"
label(analytic_cohort$Q11_YRBS_carrot) <- "Eat Carrots?"
label(analytic_cohort$Q12_YRBS_otherveg) <- "Eat Other Vegetables?"
label(analytic_cohort$Q13_YRBS_soda) <- "Drink Soda?"
label(analytic_cohort$Q14_YRBS_sportdrink) <- "Drink a Sports Drink?"
label(analytic_cohort$Q15_YRBS_water) <- "Drink Plain Water?"
label(analytic_cohort$Q16_YRBS_milk) <- "Drink Milk?"
label(analytic_cohort$Q17_YRBS_breakfast) <- "Eat Breakfast?"
# YRBS diet and physical activity items
label(analytic_cohort$Q19_YRBS_physical) <- "How Many Days Were You Physically Active for â‰¥ 60 minutes?"
label(analytic_cohort$Q20_YRBS_strength) <- "How Many Days Did You do Strength Training Exercises?"
label(analytic_cohort$Q21_YRBS_tv) <- "How Many Hours Did You Watch TV?"
label(analytic_cohort$Q22_YRBS_screentime) <- "How Many Hours Did You Play Video or Computer Games?"
# YRBS unused items
label(analytic_cohort$Q18_YRBS_allergy) <- "Foods you avoid due to allergic reaction?"
label(analytic_cohort$Q23_YRBS_pe) <- "How many school days do you have physical education?"
label(analytic_cohort$Q24_YRBS_sportsteam) <- "On how many sports teams did you play this year?"
label(analytic_cohort$Q25_YRBS_concussion) <- "How many times did you have a concussion from playing sports?"
plot_complete_items(quo(Q7_YRBS_juice)) + ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]]))
plot_complete_items(quo(Q8_YRBS_fruit)) + ggtitle(label(analytic_cohort[["Q8_YRBS_fruit"]]))
plot_complete_items(quo(Q9_YRBS_salad)) + ggtitle(label(analytic_cohort[["Q9_YRBS_salad"]]))
plot_complete_items(quo(Q10_YRBS_potato)) + ggtitle(label(analytic_cohort[["Q10_YRBS_potato"]]))
plot_complete_items(quo(Q11_YRBS_carrot)) + ggtitle(label(analytic_cohort[["Q11_YRBS_carrot"]]))
plot_complete_items(quo(Q12_YRBS_otherveg)) + ggtitle(label(analytic_cohort[["Q12_YRBS_otherveg"]]))
plot_complete_items(quo(Q13_YRBS_soda)) + ggtitle(label(analytic_cohort[["Q13_YRBS_soda"]]))
plot_complete_items(quo(Q14_YRBS_sportdrink)) + ggtitle(label(analytic_cohort[["Q14_YRBS_sportdrink"]]))
plot_complete_items(quo(Q15_YRBS_water)) + ggtitle(label(analytic_cohort[["Q15_YRBS_water"]]))
plot_complete_items(quo(Q16_YRBS_milk)) + ggtitle(label(analytic_cohort[["Q16_YRBS_milk"]]))
plot_complete_items(quo(Q17_YRBS_breakfast)) + ggtitle(label(analytic_cohort[["Q17_YRBS_breakfast"]]))
plot_complete_items(quo(Q7_YRBS_juice)) + ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]]))
plot_complete_items(quo(Q8_YRBS_fruit)) + ggtitle(label(analytic_cohort[["Q8_YRBS_fruit"]]))
plot_complete_items(quo(Q9_YRBS_salad)) + ggtitle(label(analytic_cohort[["Q9_YRBS_salad"]]))
plot_complete_items(quo(Q10_YRBS_potato)) + ggtitle(label(analytic_cohort[["Q10_YRBS_potato"]]))
plot_complete_items(quo(Q11_YRBS_carrot)) + ggtitle(label(analytic_cohort[["Q11_YRBS_carrot"]]))
plot_complete_items(quo(Q12_YRBS_otherveg)) + ggtitle(label(analytic_cohort[["Q12_YRBS_otherveg"]]))
plot_complete_items(quo(Q13_YRBS_soda)) + ggtitle(label(analytic_cohort[["Q13_YRBS_soda"]]))
plot_complete_items(quo(Q14_YRBS_sportdrink)) + ggtitle(label(analytic_cohort[["Q14_YRBS_sportdrink"]]))
plot_complete_items(quo(Q15_YRBS_water)) + ggtitle(label(analytic_cohort[["Q15_YRBS_water"]]))
plot_complete_items(quo(Q16_YRBS_milk)) + ggtitle(label(analytic_cohort[["Q16_YRBS_milk"]]))
plot_complete_items(quo(Q17_YRBS_breakfast)) + ggtitle(label(analytic_cohort[["Q17_YRBS_breakfast"]]))
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
# analytic_cohort_completecase %>%
#   mutate(Q7_YRBS_juice = str_wrap(Q7_YRBS_juice, 28)) %>%
#     ggplot(aes(x = phase, y = fct_rev(Q7_YRBS_juice), group = ID, color = cohort)) +
#     geom_line(aes(alpha = 0.01)) +
#     # add theme colors (set in first chunk)
#     yh_cohort_colors() +
#     # remove legend
#     theme(
#       plot.title = element_text(hjust = 0.5),
#       legend.position = "none",
#       axis.text.x = element_text(size = 10),
#       axis.text.y = element_text(size = 10)
#       ) +
#     stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
#   ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]])) +
#   ylab("") +
#   xlab(label = "\nPhase")
# index variable for number of words to wrap item responses
wrap_var <- 28
# format items so they are string wrapped and ordered appropriately
analytic_cohort_completecase_fct <- analytic_cohort_completecase %>%
mutate(
# YRBS diet items
Q7_YRBS_juice = Q7_YRBS_juice %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q8_YRBS_fruit = Q8_YRBS_fruit %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q9_YRBS_salad = Q9_YRBS_salad %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q10_YRBS_potato = Q10_YRBS_potato %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q11_YRBS_carrot = Q11_YRBS_carrot %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q12_YRBS_otherveg = Q12_YRBS_otherveg %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q13_YRBS_soda = Q13_YRBS_soda %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q14_YRBS_sportdrink = Q14_YRBS_sportdrink %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q15_YRBS_water = Q15_YRBS_water %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q16_YRBS_milk = Q16_YRBS_milk %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q17_YRBS_breakfast = Q17_YRBS_breakfast %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
# YRBS physical items
Q19_YRBS_physical = Q19_YRBS_physical %>% str_wrap(wrap_var),
Q20_YRBS_strength = Q20_YRBS_strength %>% str_wrap(wrap_var),
Q21_YRBS_tv = Q21_YRBS_tv %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q22_YRBS_screentime = Q22_YRBS_screentime %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
# unused YRBS items
Q18_YRBS_allergy = Q18_YRBS_allergy %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q23_YRBS_pe = Q23_YRBS_pe %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q24_YRBS_sportsteam = Q24_YRBS_sportsteam %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q25_YRBS_concussion = Q25_YRBS_concussion %>% str_wrap(wrap_var) %>% forcats::fct_rev()
)
# function to plot individual items
plot_complete_items <- function(variable){
analytic_cohort_completecase_fct %>%
drop_na_(variable) %>%
ggplot(aes(x = phase, y = !!variable, group = ID, color = cohort)) +
geom_line(aes(alpha = 0.01)) +
# add theme colors (set in first chunk)
yh_cohort_colors() +
# remove legend
theme(
plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
) +
stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
# analytic_cohort_completecase %>%
#   mutate(Q7_YRBS_juice = str_wrap(Q7_YRBS_juice, 28)) %>%
#     ggplot(aes(x = phase, y = fct_rev(Q7_YRBS_juice), group = ID, color = cohort)) +
#     geom_line(aes(alpha = 0.01)) +
#     # add theme colors (set in first chunk)
#     yh_cohort_colors() +
#     # remove legend
#     theme(
#       plot.title = element_text(hjust = 0.5),
#       legend.position = "none",
#       axis.text.x = element_text(size = 10),
#       axis.text.y = element_text(size = 10)
#       ) +
#     stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
#   ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]])) +
#   ylab("") +
#   xlab(label = "\nPhase")
# index variable for number of words to wrap item responses
wrap_var <- 28
# format items so they are string wrapped and ordered appropriately
analytic_cohort_completecase_fct <- analytic_cohort_completecase %>%
mutate(
# YRBS diet items
Q7_YRBS_juice = Q7_YRBS_juice %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q8_YRBS_fruit = Q8_YRBS_fruit %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q9_YRBS_salad = Q9_YRBS_salad %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q10_YRBS_potato = Q10_YRBS_potato %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q11_YRBS_carrot = Q11_YRBS_carrot %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q12_YRBS_otherveg = Q12_YRBS_otherveg %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q13_YRBS_soda = Q13_YRBS_soda %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q14_YRBS_sportdrink = Q14_YRBS_sportdrink %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q15_YRBS_water = Q15_YRBS_water %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q16_YRBS_milk = Q16_YRBS_milk %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q17_YRBS_breakfast = Q17_YRBS_breakfast %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
# YRBS physical items
Q19_YRBS_physical = Q19_YRBS_physical %>% str_wrap(wrap_var),
Q20_YRBS_strength = Q20_YRBS_strength %>% str_wrap(wrap_var),
Q21_YRBS_tv = Q21_YRBS_tv %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q22_YRBS_screentime = Q22_YRBS_screentime %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
# unused YRBS items
Q18_YRBS_allergy = Q18_YRBS_allergy %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q23_YRBS_pe = Q23_YRBS_pe %>% str_wrap(wrap_var) %>% forcats::fct_rev(),
Q24_YRBS_sportsteam = Q24_YRBS_sportsteam %>% str_wrap(wrap_var),
Q25_YRBS_concussion = Q25_YRBS_concussion %>% str_wrap(wrap_var)
)
# function to plot individual items
plot_complete_items <- function(variable){
analytic_cohort_completecase_fct %>%
drop_na_(variable) %>%
ggplot(aes(x = phase, y = !!variable, group = ID, color = cohort)) +
geom_line(aes(alpha = 0.01)) +
# add theme colors (set in first chunk)
yh_cohort_colors() +
# remove legend
theme(
plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
) +
stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
analytic_cohort_completecase_fct %>% glimpse
analytic_cohort %>% glimpse
# analytic_cohort_completecase %>%
#   mutate(Q7_YRBS_juice = str_wrap(Q7_YRBS_juice, 28)) %>%
#     ggplot(aes(x = phase, y = fct_rev(Q7_YRBS_juice), group = ID, color = cohort)) +
#     geom_line(aes(alpha = 0.01)) +
#     # add theme colors (set in first chunk)
#     yh_cohort_colors() +
#     # remove legend
#     theme(
#       plot.title = element_text(hjust = 0.5),
#       legend.position = "none",
#       axis.text.x = element_text(size = 10),
#       axis.text.y = element_text(size = 10)
#       ) +
#     stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
#   ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]])) +
#   ylab("") +
#   xlab(label = "\nPhase")
# index variable for number of words to wrap item responses
wrap_var <- 28
# format items so they are string wrapped and ordered appropriately
analytic_cohort_completecase_fct <- analytic_cohort_completecase
# function to plot individual items
plot_complete_items <- function(variable){
analytic_cohort_completecase_fct %>%
drop_na_(variable) %>%
ggplot(aes(x = phase, y = !!variable, group = ID, color = cohort)) +
geom_line(aes(alpha = 0.01)) +
# add theme colors (set in first chunk)
yh_cohort_colors() +
# remove legend
theme(
plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
) +
stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q7_YRBS_juice)) + ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]]))
plot_complete_items(quo(Q8_YRBS_fruit)) + ggtitle(label(analytic_cohort[["Q8_YRBS_fruit"]]))
plot_complete_items(quo(Q9_YRBS_salad)) + ggtitle(label(analytic_cohort[["Q9_YRBS_salad"]]))
plot_complete_items(quo(Q10_YRBS_potato)) + ggtitle(label(analytic_cohort[["Q10_YRBS_potato"]]))
plot_complete_items(quo(Q11_YRBS_carrot)) + ggtitle(label(analytic_cohort[["Q11_YRBS_carrot"]]))
plot_complete_items(quo(Q12_YRBS_otherveg)) + ggtitle(label(analytic_cohort[["Q12_YRBS_otherveg"]]))
plot_complete_items(quo(Q13_YRBS_soda)) + ggtitle(label(analytic_cohort[["Q13_YRBS_soda"]]))
plot_complete_items(quo(Q14_YRBS_sportdrink)) + ggtitle(label(analytic_cohort[["Q14_YRBS_sportdrink"]]))
plot_complete_items(quo(Q15_YRBS_water)) + ggtitle(label(analytic_cohort[["Q15_YRBS_water"]]))
plot_complete_items(quo(Q16_YRBS_milk)) + ggtitle(label(analytic_cohort[["Q16_YRBS_milk"]]))
plot_complete_items(quo(Q17_YRBS_breakfast)) + ggtitle(label(analytic_cohort[["Q17_YRBS_breakfast"]]))
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
# analytic_cohort_completecase %>%
#   mutate(Q7_YRBS_juice = str_wrap(Q7_YRBS_juice, 28)) %>%
#     ggplot(aes(x = phase, y = fct_rev(Q7_YRBS_juice), group = ID, color = cohort)) +
#     geom_line(aes(alpha = 0.01)) +
#     # add theme colors (set in first chunk)
#     yh_cohort_colors() +
#     # remove legend
#     theme(
#       plot.title = element_text(hjust = 0.5),
#       legend.position = "none",
#       axis.text.x = element_text(size = 10),
#       axis.text.y = element_text(size = 10)
#       ) +
#     stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
#   ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]])) +
#   ylab("") +
#   xlab(label = "\nPhase")
# index variable for number of words to wrap item responses
wrap_var <- 28
# format items so they are string wrapped and ordered appropriately
analytic_cohort_completecase_fct <- analytic_cohort_completecase %>%
mutate(
Q22_YRBS_screentime = Q22_YRBS_screentime %>% str_wrap(wrap_var),
)
# function to plot individual items
plot_complete_items <- function(variable){
analytic_cohort_completecase_fct %>%
drop_na_(variable) %>%
ggplot(aes(x = phase, y = !!variable, group = ID, color = cohort)) +
geom_line(aes(alpha = 0.01)) +
# add theme colors (set in first chunk)
yh_cohort_colors() +
# remove legend
theme(
plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
) +
stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
# analytic_cohort_completecase %>%
#   mutate(Q7_YRBS_juice = str_wrap(Q7_YRBS_juice, 28)) %>%
#     ggplot(aes(x = phase, y = fct_rev(Q7_YRBS_juice), group = ID, color = cohort)) +
#     geom_line(aes(alpha = 0.01)) +
#     # add theme colors (set in first chunk)
#     yh_cohort_colors() +
#     # remove legend
#     theme(
#       plot.title = element_text(hjust = 0.5),
#       legend.position = "none",
#       axis.text.x = element_text(size = 10),
#       axis.text.y = element_text(size = 10)
#       ) +
#     stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
#   ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]])) +
#   ylab("") +
#   xlab(label = "\nPhase")
# index variable for number of words to wrap item responses
wrap_var <- 28
# format items so they are string wrapped and ordered appropriately
analytic_cohort_completecase_fct <- analytic_cohort_completecase
# function to plot individual items
plot_complete_items <- function(variable){
analytic_cohort_completecase_fct %>%
drop_na_(variable) %>%
ggplot(aes(x = phase, y = !!variable, group = ID, color = cohort)) +
geom_line(aes(alpha = 0.01)) +
# add theme colors (set in first chunk)
scale_y_discrete(labels = wrap_format(28)) +
yh_cohort_colors() +
# remove legend
theme(
plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
) +
stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
# analytic_cohort_completecase %>%
#   mutate(Q7_YRBS_juice = str_wrap(Q7_YRBS_juice, 28)) %>%
#     ggplot(aes(x = phase, y = fct_rev(Q7_YRBS_juice), group = ID, color = cohort)) +
#     geom_line(aes(alpha = 0.01)) +
#     # add theme colors (set in first chunk)
#     yh_cohort_colors() +
#     # remove legend
#     theme(
#       plot.title = element_text(hjust = 0.5),
#       legend.position = "none",
#       axis.text.x = element_text(size = 10),
#       axis.text.y = element_text(size = 10)
#       ) +
#     stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
#   ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]])) +
#   ylab("") +
#   xlab(label = "\nPhase")
# index variable for number of words to wrap item responses
wrap_var <- 28
# function to plot individual items
plot_complete_items <- function(variable){
analytic_cohort_completecase %>%
drop_na_(variable) %>%
ggplot(aes(x = phase, y = !!variable, group = ID, color = cohort)) +
geom_line(aes(alpha = 0.01)) +
# add theme colors (set in first chunk)
scale_y_discrete(labels = wrap_format(28)) +
yh_cohort_colors() +
# remove legend
theme(
plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
) +
stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1.5, color = "black", linetype = 2) +
ylab("") +
xlab(label = "\nPhase")
}
plot_complete_items(quo(Q7_YRBS_juice)) + ggtitle(label(analytic_cohort[["Q7_YRBS_juice"]]))
plot_complete_items(quo(Q8_YRBS_fruit)) + ggtitle(label(analytic_cohort[["Q8_YRBS_fruit"]]))
plot_complete_items(quo(Q9_YRBS_salad)) + ggtitle(label(analytic_cohort[["Q9_YRBS_salad"]]))
plot_complete_items(quo(Q10_YRBS_potato)) + ggtitle(label(analytic_cohort[["Q10_YRBS_potato"]]))
plot_complete_items(quo(Q11_YRBS_carrot)) + ggtitle(label(analytic_cohort[["Q11_YRBS_carrot"]]))
plot_complete_items(quo(Q12_YRBS_otherveg)) + ggtitle(label(analytic_cohort[["Q12_YRBS_otherveg"]]))
plot_complete_items(quo(Q13_YRBS_soda)) + ggtitle(label(analytic_cohort[["Q13_YRBS_soda"]]))
plot_complete_items(quo(Q14_YRBS_sportdrink)) + ggtitle(label(analytic_cohort[["Q14_YRBS_sportdrink"]]))
plot_complete_items(quo(Q15_YRBS_water)) + ggtitle(label(analytic_cohort[["Q15_YRBS_water"]]))
plot_complete_items(quo(Q16_YRBS_milk)) + ggtitle(label(analytic_cohort[["Q16_YRBS_milk"]]))
plot_complete_items(quo(Q17_YRBS_breakfast)) + ggtitle(label(analytic_cohort[["Q17_YRBS_breakfast"]]))
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
plot_complete_items(quo(Q19_YRBS_physical)) + ggtitle(label(analytic_cohort[["Q19_YRBS_physical"]]))
plot_complete_items(quo(Q20_YRBS_strength)) + ggtitle(label(analytic_cohort[["Q20_YRBS_strength"]]))
plot_complete_items(quo(Q21_YRBS_tv)) + ggtitle(label(analytic_cohort[["Q21_YRBS_tv"]]))
plot_complete_items(quo(Q22_YRBS_screentime)) + ggtitle(label(analytic_cohort[["Q22_YRBS_screentime"]]))
plot_complete_items(quo(Q18_YRBS_allergy)) + ggtitle(label(analytic_cohort[["Q18_YRBS_allergy"]]))
plot_complete_items(quo(Q23_YRBS_pe)) + ggtitle(label(analytic_cohort[["Q23_YRBS_pe"]]))
plot_complete_items(quo(Q24_YRBS_sportsteam)) + ggtitle(label(analytic_cohort[["Q24_YRBS_sportsteam"]]))
plot_complete_items(quo(Q25_YRBS_concussion)) + ggtitle(label(analytic_cohort[["Q25_YRBS_concussion"]]))
